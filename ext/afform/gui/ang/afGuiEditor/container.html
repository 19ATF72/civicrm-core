<div class="af-gui-bar" ng-if="node['#tag'] !== 'af-form'" ng-click="selectEntity()" >
  <div class="form-inline" af-gui-menu>
    <span ng-if="container.getNodeType(node) == 'fieldset'">{{ editor.getEntity(entityName).label }}</span>
    <span ng-if="block">{{ ts('%1 block:', {1: block}) }}</span>
    <span ng-if="!block">{{ tags[node['#tag']].toLowerCase() }}</span>
    <select ng-if="block" ng-model="selectedBlock.name">
      <option value="">{{ ts('Custom') }}</option>
      <option value="{{ option.id }}" ng-repeat="option in selectedBlock.options track by option.id">{{ option.text }}</option>
    </select>
    <button type="button" class="btn btn-default btn-xs dropdown-toggle af-gui-add-element-button pull-right" data-toggle="dropdown" title="{{ ts('Add Element') }}">
      <span><i class="crm-i fa-plus"></i></span>
    </button>
    <ul class="dropdown-menu dropdown-menu-right" ng-if="menu.open" ng-include="'~/afGuiEditor/container-menu.html'"></ul>
  </div>
</div>
<div class="af-gui-bar" ng-if="node['#tag'] === 'af-form'" >
  <div class="form-inline pull-right" af-gui-menu>
    <button type="button" class="btn  btn-default btn-sm dropdown-toggle af-gui-add-canvas-button" data-toggle="dropdown" title="{{ ts('Add Element') }}">
      <span>Add <i class="crm-i fa-plus"></i></span>
    </button>
    <ul class="dropdown-menu" ng-if="menu.open" ng-include="'~/afGuiEditor/canvas-menu.html'"></ul>
  </div>
</div>
<div ui-sortable="{handle: '.af-gui-bar', update: onDrop, connectWith: '[ui-sortable]', cancel: 'input,textarea,button,select,option,a,.dropdown-menu'}" ng-model="getSetChildren" ng-model-options="{getterSetter: true}" class="af-gui-layout {{ getLayout() }}">
  <div ng-repeat="item in getSetChildren()" >
    <div ng-switch="container.getNodeType(item)">
      <div ng-switch-when="fieldset" af-gui-container="item" style="{{ item.style }}" class="af-gui-container af-gui-fieldset af-gui-container-type-{{ item['#tag'] }}" ng-class="{'af-entity-selected': isSelectedFieldset(item['af-fieldset'])}" entity-name="item['af-fieldset']" data-entity="{{ item['af-fieldset'] }}" />
      <div ng-switch-when="container" af-gui-container="item" style="{{ item.style }}" class="af-gui-container af-gui-container-type-{{ item['#tag'] }}" entity-name="entityName" data-entity="{{ entityName }}" />
      <div ng-switch-when="block" af-gui-container="item"  style="{{ item.style }}" class="af-gui-container af-gui-block" block="item['af-block']" entity-name="entityName + '-block-' + item['af-block']" data-entity="{{ entityName + '-block-' + item['af-block'] }}" />
      <div ng-switch-when="field" af-gui-field="item" />
      <div ng-switch-when="text" af-gui-text="item" class="af-gui-element af-gui-text" />
      <div ng-switch-when="markup" af-gui-markup="item" class="af-gui-markup" />
      <div ng-switch-when="button" af-gui-button="item" class="af-gui-element af-gui-button" />
    </div>
  </div>
</div>
<div ng-if="block && !(node.min === '1' && node.max === '1')" class="af-gui-button">
  <button class="btn btn-xs btn-primary disabled">
    <span class="crm-editable-enabled" ng-click="pickAddIcon()" >
      <i class="crm-i {{ node['add-icon'] || 'fa-plus' }}"></i>
    </span>
    <span af-gui-editable ng-model="node['add-label']">{{ node['add-label'] }}</span>
  </button>
</div>
